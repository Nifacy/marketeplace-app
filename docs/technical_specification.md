## Описание проекта

Целью нашего проекта является создание веб-сервиса для управления заказами в магазине. Приложение предоставляет возможность продавцам размещать свои товары для продажи, а покупателям - приобретать эти товары. Наша область ответственности ограничивается процессом совершения покупок. Мы не занимаемся:

- хранением товаров
- доставкой товаров покупателям
- обработкой платежей

Существующие аналоги в реальном мире: Юла, Avito.

##  Стадии реализации проекта

Важно отметить, что на данном этапе нашей целью является реализация MVP (Минимально жизнеспособного продукта). Это означает, что в процессе разработки мы придерживаемся следующих принципов:

- Приоритет отдается решениям, которые можно быстро и легко внедрить.
- При проектировании мы стараемся избегать лишних деталей.

Важно понимать, что MVP не будет представлять собой полноценный продукт, но будет рабочим. После реализации MVP у нас будет возможность постепенно улучшать и добавлять функциональность в проект. Графически процесс разработки можно представить следующим образом:

```mermaid
gitGraph

    commit id: " "

    commit id: "  "

    branch MVP

    checkout MVP

    commit id: "   "

    checkout main

    merge MVP

  

    branch "Feature 1"

    checkout "Feature 1"

    commit id: "    "

    checkout main

    merge "Feature 1"

  

    branch "Feature 2"

    checkout "Feature 2"

    commit id: "     "

    checkout main
    branch "Feature 3"
    checkout "Feature 3"
    commit id: "      "
    checkout main

    merge "Feature 3"
    merge "Feature 2"
```

## Описание предметной области

В нашей предметной области существуют следующие сущности: покупатель, продавец, администрация, витрина, товар и заказ. Сущности "покупатель", "продавец" и "администрация" являются клиентами нашего продукта и взаимодействуют с приложением.

### Товар

Под товаром понимается продукт, размещенный продавцом на витрине. Каждый товар обязательно содержит следующую информацию:
- Цена товара.
- Изображения (для визуального представления).
- Название товара и его краткое описание.
- Информация о продавце, владельце данного товара.

### Витрина

Витрина представляет собой абстракцию, объединяющую все товары, предложенные продавцами для продажи, в едином месте. Она служит хранилищем для всех товаров, делая их доступными для покупателей. Витрина поддерживает следующие сценарии:

- **Добавление товара на витрину:** Этот сценарий доступен только продавцам. После добавления товара на витрину, он становится доступным для покупателей.
- **Удаление товара с витрины:** Этот сценарий также доступен только продавцам. После удаления товара с витрины, он перестает быть доступным для покупателей.

### Заказ

Сущность "Заказ" предназначена для отслеживания статуса процесса покупки товара и хранения основных связанных с ним данных. Каждый заказ содержит следующую информацию:

- **Статус заказа:** Заказ может находиться в следующих состояниях:
	- `CREATED` - заказ создан и ожидает подтверждения от продавца
	- `CONFIRMED` - продавец подтвердил заказ, ожидание оплаты от покупателя
	- `PAID` - заказ оплачен, ожидание отправки через службу доставки
	- `SENT TO DELIVERY` - заказ отправлен через службу доставки, ожидание получения
	- `PICKED UP` - покупатель забрал заказ
	- `CANCELED` - заказ был отменен по некоторой причине
- **Причина отмены:** Краткое описание причины отмены заказа (обязательно только для состояния `CANCELED`).
- **Цена заказа:** Заказ фиксирует цену товара, что гарантирует, что цена не изменится после изменения цены товара продавцом.
- **Заказанный товар:** Заказ связан с конкретным товаром, что позволяет покупателю просматривать соответствующий товар.
- **Дата создания заказа:** Дата, когда заказ был создан покупателем (устанавливается системой).
- **Адрес доставки:** Адрес, на который продавец должен отправить товар, предоставляется покупателем.
- **Покупатель:** Заказ хранит информацию о покупателе, который сделал заказ.

### Продавец

Продавец - это один из типов клиентов нашего продукта. Продавец представляет собой физическое лицо, не являющееся юридическим лицом. Продавец может взаимодействовать с нашим продуктом следующим образом:

- **Просмотр товаров:** Продавец может просматривать все свои выложенные товары на витрине.
- **Редактирование товаров:** Продавец может изменять информацию о своих товарах, включая цену, описание, название и изображения.
- **Просмотр заказов:** Продавец может просматривать все заказы, которые были созданы на его товары.
- **Подтверждение заказа:** Продавец может подтверждать заказы, отправленные покупателями.
- **Отправка заказа:** Продавец может обновлять статус заказа после отправки его через службу доставки.
- **Добавление товара на витрину:** Продавец может выставлять товар на продажу.
- **Удаление товара с витрины:** Продавец может снимать товар с продажи. Важно отметить, что информация о товаре сохраняется, но он помечается как "снят с продажи".

Каждый продавец имеет свой личный аккаунт и должен предоставить следующую информацию о себе:

- Фамилия, имя, отчество.
- Телефон.
- Почта.
- Дополнительная контактная информация (ссылки на Telegram, WhatsApp и т. д.), которая является необязательной.

### Покупатель

Покупатель - это один из типов клиентов нашего продукта. Покупатель может взаимодействовать с нашим приложением следующим образом:

- **Просмотр витрины:** Покупатель может просматривать товары, размещенные на продажу.
- **Оформление заказа:** Покупатель может создавать заказы на выбранные товары.
- **Подтверждение получения заказа:** Покупатель может подтверждать, что заказ был получен им вручную.
- **Просмотр заказов:** Покупатель имеет доступ к истории своих заказов, включая завершенные и активные заказы.

Каждый покупатель имеет свой личный аккаунт и должен предоставить соответствующую информацию о себе, включая:

- Фамилия, имя, отчество.
- Телефон.
- Почта.
- Дополнительная контактная информация (по желанию).

### Администрация

Администрация - это один из типов клиентов нашего продукта. В системе у администрации есть общий аккаунт, предназначенный для управления и решения исключительных ситуаций, которые могут возникнуть в процессе обработки заказов. Администрация имеет полный доступ к информации о заказах, включая возможность их редактирования и просмотра.

Покупатели и продавцы могут связываться с администрацией через контактные данные, такие как телефон и почта.

## Описание базовых процессов

Далее описываются основные процессы, которые происходят в нашей системе, и роли, которые клиенты играют в этих процессах.

### Покупка товара

1. Покупатель выбирает товар на витрине и начинает процесс оформления заказа. Он заполняет адрес доставки, проверяет итоговую цену заказа и нажимает "Оформить". После оформления заказа создается сущность заказа со статусом `CREATED`.

2. Продавец проверяет, может ли выполнить данный заказ, осуществляя проверку своего склада и других условий. Если продавец может выполнить заказ, он изменяет статус заказа на `CONFIRMED`. В противном случае, заказ отменяется с указанием причины и статусом `CANCELED`.

3. После подтверждения заказа продавцом, покупатель производит оплату заказа.

> [!WARNING]
> **Случай 1:**
> Если продавец не получает оплату в течение длительного времени, он связывается с администрацией или покупателем. В крайнем случае, администрация может изменить статус заказа на `CANCELED`.


1. Продавец подтверждает оплату и изменяет статус заказа изменяется на `PAID`. Заказ готовится к отправке.

> [!WARNING]
> **Случай 2:**
> Если покупатель отправил оплату, но продавец не обновляет статус, покупатель может связаться с продавцом (используя указанные контакты) или обратиться в службу поддержки. Если статус остается неподтвержденным, администрация может изменить статус заказа на `CANCELED` и помочь разрешить проблему.

3. После передачи заказа в службу доставки, продавец устанавливает статус заказа на `SENT TO DELIVERY`.

> [!WARNING]
> **Случай 3:**
> Если продавец долго не отправляет заказ, покупатель также может обратиться к продавцу или службе поддержки. В этом случае одним из вариантов может быть изменение статуса заказа на `CANCELED`.

4. После получения посылки от службы доставки, покупатель проверяет состояние товара и изменяет статус заказа на `PICKED UP`.

> [!WARNING]
> **Случай 4:**
> Если посылка долго не доставляется из-за службы доставки, покупатель и продавец могут сами договориться. В этом случае один из них может изменить статус заказа на `CANCELED`.

> [!WARNING]
> **Случай 5:**
> Если покупатель долго не обновляет статус заказа, продавец или администрация связываются с ним. В этом случае одним из вариантов может быть принудительное изменение статуса заказа на `PICKED UP`.

### Добавление товара на витрину

1. Продавец переходит в раздел "Товары" и нажимает кнопку "Добавить". Это открывает диалоговое окно для редактирования основной информации о товаре.

2. После внесения всех данных о товаре, продавец нажимает кнопку "Добавить" в диалоговом окне, что отправляет запрос на сервер.

3. После успешной обработки запроса для создания товара, список товаров продавца в разделе "Товары" обновляется, и новый товар отображается в списке.

> [!NOTE]
> **Валидация данных:**
> Валидация данных выполняется на серверной стороне. Если отправленные данные не соответствуют установленным правилам, сервер должен вернуть соответствующую ошибку.

> [!NOTE]
> **Технические неполадки:**
> В случае возникновения технических неполадок на сервере, продавцу должно отобразиться сообщение с информацией о необходимости повторить запрос позже.

### Снятие товаров с продажи

1. Продавец переходит в раздел "Товары" и выбирает товар, который он хочет снять с продажи.

2. Продавец нажимает на кнопку "Снять с продажи" для выбранного товара, и отправляется запрос на сервер для снятия товара с витрины.

> [!NOTE]
> **Удаление при созданных заказах:**
> Если на момент снятия товара с продажи уже созданы заказы с состоянием `CREATED` для этого товара, то их статус меняется на `CANCELED`, и указывается причина: "Товар снят с продажи".

## Описание функционала

На основе описания предметной области, можно сформировать следующие функциональные блоки приложения:

**Продавец**
1. **Регистрация**: Пользователь может зарегистрировать аккаунт продавца в системе.
2. **Авторизация**: Продавец может войти в уже существующий аккаунт.
3. **Просмотр профиля**: В системе можно просмотреть профиль продавца, его товарах, которые он продает, и контактные данные.
4. **Управление товарами**: Продавец имеет доступ к окну управления товарами, где он может добавлять товары на продажу, редактировать их информацию и снимать их с продажи.
5. **Управление заказами**: Продавцу предоставляется окно управления заказами, где он может просматривать информацию о заказах, их статусы и устанавливать новые статусы в соответствии с описанным сценарием.

**Покупатель**
1. **Регистрация**: Пользователь может зарегистрировать аккаунт покупателя в системе.
2. **Авторизация**: Покупатель может войти в уже существующий аккаунт.
3. **Просмотр профиля**: В системе можно просмотреть профиль покупателя, включая ФИО и контактные данные.
4. **Управление заказами**: Покупателям доступно окно управления заказами, где они могут просматривать информацию о своих заказах, обновлять статусы и уведомлять продавцов о получении товара.
5. **Просмотр витрины**: Покупатели могут просматривать товары, размещенные на продажу, и получать более подробную информацию о них.

**Администрация**
1. **Авторизация**: Служба поддержки может войти в систему от имени администрации.
2. **Управление заказами**: Администрация может просматривать все заказы, устанавливать фильтры для поиска и управлять ими.
3. **Управление товарами**: Администрация имеет доступ к просмотру всех созданных товаров в системе.

## Технические требования

- Backend: Python с использованием FastAPI и asyncio.
- Frontend: React.
- База данных: PostgreSQL.

## Что будет реализовано в дальнейшем

Здесь описаны возможные дополнительные функции, которые могут быть добавлены в будущем:

**1. Учет количества товаров**
Добавление возможности отслеживать количество товаров, имеющихся в наличии у продавца. Это позволит продавцу автоматически снимать товар с витрины, когда они заканчиваются.

**2. Уведомления (popups)**
Внедрение системы уведомлений для информирования пользователей о изменениях статусов заказов и необходимых действиях.

**3. Интеграция с сервисами оплаты**
Добавление поддержки различных сервисов оплаты, упрощающих процесс оплаты и повышающих доверие пользователей.

**4. Интеграция с службой доставки**
Интеграция с курьерской службой доставки для более точного отслеживания статуса заказа и уведомления пользователей о доставке.

**5. Рейтинг и отзывы**
Добавление системы рейтинга и отзывов, которая позволит пользователям оценивать продавцов и товары. Это может повысить доверие к продавцам и помочь покупателям выбирать лучшие товары.
